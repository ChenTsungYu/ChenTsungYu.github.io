<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>[Kubernetes] Kubernetes 基礎(二) Pod 操作 - Tom&#039;s Blog</title><link rel="manifest" href="../../../../../../manifest.json"><meta name="application-name" content="Tom&#039;s Blog"><meta name="msapplication-TileImage" content="/img/dragon_red.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Tom&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="前言 延續上一篇[Kubernetes] Kubernetes 基礎(ㄧ) 架構及元件討論 Kubernetes 的架構與元件後，接著來探討如何操作 Kubernetes  的 Pod 元件吧！   以下簡稱 Kubernetes 為 K8s。"><meta property="og:type" content="blog"><meta property="og:title" content="[Kubernetes] Kubernetes 基礎(二) Pod 操作"><meta property="og:url" content="https://github.com/ChenTsungYu/2021/09/10/DevOps/K8s/[Kubernetes]%20Kubernetes%20%E5%9F%BA%E7%A4%8E(%E4%BA%8C)%20Pod%20%E6%93%8D%E4%BD%9C/"><meta property="og:site_name" content="Tom&#039;s Blog"><meta property="og:description" content="前言 延續上一篇[Kubernetes] Kubernetes 基礎(ㄧ) 架構及元件討論 Kubernetes 的架構與元件後，接著來探討如何操作 Kubernetes  的 Pod 元件吧！   以下簡稱 Kubernetes 為 K8s。"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://miro.medium.com/max/240/0*X-_IGBEAB88amxNO.png"><meta property="og:image" content="https://i.imgur.com/202flKJ.png"><meta property="article:published_time" content="2021-09-10T00:00:10.000Z"><meta property="article:modified_time" content="2021-09-30T14:38:49.153Z"><meta property="article:author" content="Tsung Yu Chen"><meta property="article:tag" content="Kubernetes"><meta property="article:tag" content="K8s"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://miro.medium.com/max/240/0*X-_IGBEAB88amxNO.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://github.com/ChenTsungYu/2021/09/10/DevOps/K8s/[Kubernetes]%20Kubernetes%20%E5%9F%BA%E7%A4%8E(%E4%BA%8C)%20Pod%20%E6%93%8D%E4%BD%9C/"},"headline":"[Kubernetes] Kubernetes 基礎(二) Pod 操作","image":["https://miro.medium.com/max/240/0*X-_IGBEAB88amxNO.png","https://i.imgur.com/202flKJ.png"],"datePublished":"2021-09-10T00:00:10.000Z","dateModified":"2021-09-30T14:38:49.153Z","author":{"@type":"Person","name":"Tsung Yu Chen"},"publisher":{"@type":"Organization","name":"Tom's Blog","logo":{"@type":"ImageObject","url":"https://github.com/img/dragon_blue.png"}},"description":"前言 延續上一篇[Kubernetes] Kubernetes 基礎(ㄧ) 架構及元件討論 Kubernetes 的架構與元件後，接著來探討如何操作 Kubernetes  的 Pod 元件吧！   以下簡稱 Kubernetes 為 K8s。"}</script><link rel="canonical" href="https://github.com/ChenTsungYu/2021/09/10/DevOps/K8s/[Kubernetes]%20Kubernetes%20%E5%9F%BA%E7%A4%8E(%E4%BA%8C)%20Pod%20%E6%93%8D%E4%BD%9C/"><link rel="icon" href="../../../../../../img/dragon_red.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="../../../../../../css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="../../../../../../index.html"><img src="../../../../../../img/dragon_blue.png" alt="Tom&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="../../../../../../index.html">Home</a><a class="navbar-item" href="../../../../../../archives">Archives</a><a class="navbar-item" href="../../../../../../categories">Categories</a><a class="navbar-item" href="../../../../../../tags">Tags</a><a class="navbar-item" href="../../../../../../about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="../../../../../../https:/github.com/ChenTsungYu"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-09-10T00:00:10.000Z" title="9/10/2021, 8:00:10 AM">2021/09/10</time></span><span class="level-item"><a class="link-muted" href="../../../../../../categories/DevOps/">DevOps</a></span><span class="level-item">18 minutes read (About 2691 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">[Kubernetes] Kubernetes 基礎(二) Pod 操作</h1><div class="content"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><img src="https://miro.medium.com/max/240/0*X-_IGBEAB88amxNO.png" alt=""></p>
<p>延續上一篇<a target="_blank" rel="noopener" href="https://chentsungyu.github.io/2021/09/07/DevOps/K8s/%5BKubernetes%5D%20Kubernetes%20%E5%9F%BA%E7%A4%8E(%E3%84%A7)%20%E6%9E%B6%E6%A7%8B%E5%8F%8A%E5%85%83%E4%BB%B6/">[Kubernetes] Kubernetes 基礎(ㄧ) 架構及元件</a>討論 Kubernetes 的架構與元件後，接著來探討如何操作 Kubernetes  的 Pod 元件吧！ </p>
<blockquote>
<p>以下簡稱 Kubernetes 為 <strong>K8s</strong>。</p>
</blockquote>
<span id="more"></span>
<p>在正式操作前，先認識一下什麼是 <strong>kubectl</strong></p>
<h1 id="Kubectl"><a href="#Kubectl" class="headerlink" title="Kubectl"></a>Kubectl</h1><p>kubectl 是 Kubernetes 的命令列工具(Command Line tool)，透過指令的方式來管理整個 Kubernetes Cluster，如：取得 Cluster 各種不同資源資訊, 配置運行資源等，使用 Kubectl 前要先了解幾個常用的參數:</p>
<ul>
<li>Namespace</li>
<li>Completion</li>
</ul>
<h2 id="命名空間-Namespace"><a href="#命名空間-Namespace" class="headerlink" title="命名空間 (Namespace)"></a>命名空間 (Namespace)</h2><p>透過命名空間在 Cluster 內將不同資源(Container, storage, Network 等)區分開來</p>
<h2 id="自動補全-Completion"><a href="#自動補全-Completion" class="headerlink" title="自動補全 (Completion)"></a>自動補全 (Completion)</h2><p>Kubernetes 提供自動補全 bash 指令的功能，透過 <code>Tab</code> 鍵幫助我們在使用 Kubectl 指令時，快速地把指令補完，執行下述指令就能啟用這項功能</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">source</span> &lt;(kubectl completion bash)<br></code></pre></td></tr></table></figure>

<h2 id="讀取-Kubernetes-資源的相關指令-Get"><a href="#讀取-Kubernetes-資源的相關指令-Get" class="headerlink" title="讀取 Kubernetes 資源的相關指令 - Get"></a>讀取 Kubernetes 資源的相關指令 - Get</h2><h3 id="讀取某個-NameSpace-下的所有-Pods-資訊"><a href="#讀取某個-NameSpace-下的所有-Pods-資訊" class="headerlink" title="讀取某個 NameSpace 下的所有 Pods 資訊"></a>讀取某個 NameSpace 下的所有 Pods 資訊</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">kubectl -n &lt;NameSpace&gt; <span class="hljs-builtin-name">get</span> pods<br></code></pre></td></tr></table></figure>
<h3 id="讀取某個-NameSpace-下特定的-Pods-資訊"><a href="#讀取某個-NameSpace-下特定的-Pods-資訊" class="headerlink" title="讀取某個 NameSpace 下特定的 Pods 資訊"></a>讀取某個 NameSpace 下特定的 Pods 資訊</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">kubectl -n <span class="hljs-symbol">&lt;NameSpace&gt;</span> <span class="hljs-built_in">get</span> pods <span class="hljs-symbol">&lt;PodName&gt;</span><br></code></pre></td></tr></table></figure>

<blockquote>
<p>若想看更詳細的資訊(e.g. NODE, IP..)，可以在指令後方加上參數 <code>-o=wide</code></p>
</blockquote>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">kubectl -n &lt;NameSpace&gt; <span class="hljs-builtin-name">get</span> pods &lt;PodName&gt; <span class="hljs-attribute">-o</span>=wide<br></code></pre></td></tr></table></figure>

<p>也可改以 <code>yaml</code> 的形式描述 container ，參數改為 <code>-o=yaml</code> or JSON 形式: <code>-o=json</code></p>
<blockquote>
<p>Kubernetes 有提供 <strong>json path</strong> 做較為複雜的輸出方式，如 <code>-0=jsonpath=&#39;...&#39;</code> </p>
</blockquote>
<h3 id="監聽-Pod-Watch"><a href="#監聽-Pod-Watch" class="headerlink" title="監聽 Pod - Watch"></a>監聽 Pod - Watch</h3><p>監聽 container 的變動，在部署的時候，可透過 watch 的方式去看某些 container 的變化是否如預期。<br>在指令裡加上參數 <code>-w</code> 即可</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">kubectl -n <span class="hljs-symbol">&lt;NameSpace&gt;</span> <span class="hljs-built_in">get</span> pods <span class="hljs-symbol">&lt;PodName&gt;</span> -<span class="hljs-keyword">w</span><br></code></pre></td></tr></table></figure>

<h2 id="讀取-Kubernetes-資源的相關指令-Describe"><a href="#讀取-Kubernetes-資源的相關指令-Describe" class="headerlink" title="讀取 Kubernetes 資源的相關指令 - Describe"></a>讀取 Kubernetes 資源的相關指令 - Describe</h2><p>用更上層的角度去看待資源，將多個事件、資源的資訊整合在一起，統一回傳給使用者，在 debug 時挺好用的指令</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">kubectl -n <span class="hljs-tag">&lt;<span class="hljs-name">NameSpace</span>&gt;</span> describe pods <span class="hljs-tag">&lt;<span class="hljs-name">PodName</span>&gt;</span><br></code></pre></td></tr></table></figure>
<h1 id="Kubeconfig-的管理"><a href="#Kubeconfig-的管理" class="headerlink" title="Kubeconfig 的管理"></a>Kubeconfig 的管理</h1><p>Kubeconfig 包含各式各樣的資訊 e.g. Cluster(一個 or 多個), user，可藉由 <code>kubectl</code> 來幫助我們管理這些資訊，<code>kubectl</code> 是一支用來與 k8s 叢集溝通的二進位 (binary) 工具。</p>
<p>我們可以運用 kubectl 來，除此之外，Kubeconfig 有個重要概念: <strong>Context</strong> </p>
<h2 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h2><p>以怎樣的身份(user)、基於預設的 Namespaces 去存取特定的 Cluster資訊，<strong>是 Kubeconfig 的最小單元</strong>，故操作 Kubeconfig 時都是以 Context 作為最小原件去操作。</p>
<h2 id="Kubeconfig-範例格式"><a href="#Kubeconfig-範例格式" class="headerlink" title="Kubeconfig 範例格式"></a>Kubeconfig 範例格式</h2><p>主要分三大類別: <strong>Cluster, Context, User</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span> <span class="hljs-comment"># 該元件的版本號</span><br><span class="hljs-attr">Kind:</span> <span class="hljs-comment"># 該元件屬性 e.g. Pod, Deployment, Service, Namespace, ReplicationController</span><br><span class="hljs-attr">clusters:</span> <span class="hljs-comment"># 描述多個 clusters</span><br><span class="hljs-bullet">-</span> <span class="hljs-attr">cluster:</span><br>    <span class="hljs-attr">certificate-authority-data:</span>  <span class="hljs-comment"># 描述 Certificate 的資訊</span><br>    <span class="hljs-attr">server:</span> <span class="hljs-comment"># 紀錄連接的 Cluster 的位置</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-comment"># Cluster 名稱</span><br> <br><span class="hljs-attr">contexts:</span><br><span class="hljs-bullet">-</span> <span class="hljs-attr">context:</span> <span class="hljs-comment"># 把 user 和 cluster 資訊整合至 context</span><br>    <span class="hljs-attr">cluster:</span> <br>    <span class="hljs-attr">namespace:</span> <span class="hljs-comment">#</span><br>    <span class="hljs-attr">user:</span> <span class="hljs-comment">#</span><br><span class="hljs-attr">users:</span><br><span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-comment"># 此處定義 user 名稱</span><br>  <span class="hljs-attr">user:</span><br>    <span class="hljs-attr">client-certificate:</span> <span class="hljs-comment"># user 相關的 credential</span><br>    <span class="hljs-attr">client-key:</span> <span class="hljs-comment"># user 相關的 credential</span><br></code></pre></td></tr></table></figure>

<h1 id="Kubeconfig-相關指令"><a href="#Kubeconfig-相關指令" class="headerlink" title="Kubeconfig 相關指令"></a>Kubeconfig 相關指令</h1><p>部署 Service 到 K8s Cluster 時，可把相關部署資源等資訊先定義於 yaml 上，再透過 <code>kubectl</code> 的指令建立所需資源</p>
<h2 id="對-Pod-操作-Imperative-Management-命令式管理"><a href="#對-Pod-操作-Imperative-Management-命令式管理" class="headerlink" title="對 Pod 操作 (Imperative Management; 命令式管理)"></a>對 Pod 操作 (Imperative Management; 命令式管理)</h2><p>通過這種方法告訴Kubernetes API你要創建，替換或刪除的內容</p>
<h3 id="建立-amp-查看-Pod"><a href="#建立-amp-查看-Pod" class="headerlink" title="建立&amp;查看 Pod"></a>建立&amp;查看 Pod</h3><p>要在 K8s 上部署一項資源到 Pod 上，可以對事先定義好的 <code>yaml</code> 檔案執行 <code>kubectl</code> 的指令，<code>yaml</code> 檔照下方範例，部署一個 Nginx  服務到 Pod 上:<br><code>pod.yaml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Pod</span> <span class="hljs-comment"># 指定為 Pod</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">myapp-pod-nginx-demo</span><br>  <span class="hljs-attr">labels:</span><br>    <span class="hljs-attr">app:</span> <span class="hljs-string">myapp-pod-nginx-demo</span> <span class="hljs-comment"># 定義好 Label 用於辨認</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">containers:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">myapp-pod-nginx-demo</span> <span class="hljs-comment"># 自訂的容器名稱</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">nginx</span> <span class="hljs-comment"># container 指定的 Image</span><br>    <span class="hljs-attr">resources:</span> <span class="hljs-comment"># 給定索取資源的上限</span><br>      <span class="hljs-attr">limits:</span><br>        <span class="hljs-attr">cpu:</span> <span class="hljs-string">200m</span><br>        <span class="hljs-attr">memory:</span> <span class="hljs-string">200Mi</span><br>      <span class="hljs-attr">requests:</span><br>          <span class="hljs-attr">cpu:</span> <span class="hljs-string">100m</span><br>          <span class="hljs-attr">memory:</span> <span class="hljs-string">64Mi</span><br></code></pre></td></tr></table></figure>
<p>搭配 <code>kubectl create</code> 指令加上參數 <code>-f</code>，後面接定義好的檔案部署資源:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">kubectl</span> <span class="hljs-string">create</span> <span class="hljs-string">-f</span> <span class="hljs-string">pod.yaml</span><br></code></pre></td></tr></table></figure>
<p>如果要查看 Pod 狀態，可以下 <code>get pod</code> 指令，後面接剛剛件好的 Pod 名稱</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">kubectl</span> <span class="hljs-string">get</span> <span class="hljs-string">pod</span> <span class="hljs-string">myapp-pod-nginx-demo</span><br></code></pre></td></tr></table></figure>
<p><strong>output</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">NAME</span>                   <span class="hljs-string">READY</span>   <span class="hljs-string">STATUS</span>    <span class="hljs-string">RESTARTS</span>   <span class="hljs-string">AGE</span><br><span class="hljs-string">myapp-pod-nginx-demo</span>   <span class="hljs-number">1</span><span class="hljs-string">/1</span>     <span class="hljs-string">Running</span>   <span class="hljs-number">0</span>          <span class="hljs-string">1m</span><br></code></pre></td></tr></table></figure>

<p>想看更細部的資訊(name space, Node, Label, Containers等等)可以用 <code>describe pod</code> 的指令</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">kubectl</span> <span class="hljs-string">describe</span> <span class="hljs-string">pod</span> <span class="hljs-string">myapp-pod-nginx-demo</span><br></code></pre></td></tr></table></figure>
<h3 id="刪除-Pod"><a href="#刪除-Pod" class="headerlink" title="刪除 Pod"></a>刪除 Pod</h3><p>若不需要這個 Pod 了，要將其移除可下 <code>delete pod</code>，或是 <code>delete -f</code> 接定義好的 yaml 檔</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">kubectl</span> <span class="hljs-string">delete</span> <span class="hljs-string">pod</span> <span class="hljs-string">myapp-pod-nginx-demo</span><br><span class="hljs-comment"># or</span><br><span class="hljs-string">kubectl</span> <span class="hljs-string">delete</span> <span class="hljs-string">-f</span> <span class="hljs-string">pod.yaml</span><br></code></pre></td></tr></table></figure>
<h3 id="編輯-Pod"><a href="#編輯-Pod" class="headerlink" title="編輯 Pod"></a>編輯 Pod</h3><p>透過 <code>edit pod</code> 針對當前運作中的資源進行更新/替換，不需重新部署</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">kubectl</span> <span class="hljs-string">edit</span> <span class="hljs-string">pod</span> <span class="hljs-string">myapp-pod-nginx-demo</span><br></code></pre></td></tr></table></figure>
<p>雖然上面定義好的 <code>pod.yaml</code> 很簡短，但實際部署到系統時， K8s 的 API Server 會自動補上其他資訊，大部分都是系統預設值 e.g. DNS 設定、重啟政策</p>
<h2 id="對-Pod-操作-Declarative-Management-聲明式管理"><a href="#對-Pod-操作-Declarative-Management-聲明式管理" class="headerlink" title="對 Pod 操作 (Declarative Management; 聲明式管理)"></a>對 Pod 操作 (Declarative Management; 聲明式管理)</h2><p>根據配置文件裡面列出的内容進行資源部署、修改及刪除等操作，讓 K8s 幫你維護資源狀態，概念比較偏向是告訴 Kubernetes 希望擁有的資源及狀態，確認資源應該要長什麼樣子，相較於 <code>create</code> 單純是創造的概念。 故根據資源狀態產生兩個對應的動詞: <code>apply</code>, <code>diff</code></p>
<h3 id="kubectl-apply"><a href="#kubectl-apply" class="headerlink" title="kubectl apply"></a>kubectl apply</h3><p><strong>語法</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl apply -f &lt;file&gt;<br></code></pre></td></tr></table></figure>
<p>or</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl apply -f &lt;folder&gt;<br></code></pre></td></tr></table></figure>
<p>透過 <code>apply</code> 指令根據已經定義好的<strong>一個 or 多個</strong> yaml 檔，也可針對資料夾用遞迴的方式，把資料夾內的所有 yaml 檔送到 Kubernetes 裡面，告訴 Kubernetes 確保 yaml 描述的狀態與 Kubernetes 裡面完全一致。</p>
<h3 id="kubectl-diff"><a href="#kubectl-diff" class="headerlink" title="kubectl diff"></a>kubectl diff</h3><p><code>diff</code> 指令是在 <code>apply</code> 檔案時，跟目前 Kubernetes 檔案描述的狀態有哪些差異，修改哪些地方？有哪些變化？</p>
<h3 id="Work-Flow"><a href="#Work-Flow" class="headerlink" title="Work Flow"></a>Work Flow</h3><p>接著看張圖理解 <code>apply</code> 的流程：<br><img src="https://i.imgur.com/202flKJ.png" alt=""></p>
<p><strong>圖片上半部分:</strong></p>
<p>左邊的 Config yaml 為定義 K8s 資源的 yaml 檔，描述 A ~ E 等多項資源，接著透過 <code>apply</code> 指令寫到 K8s 裡，K8s 會根據 yaml 檔描述的內容及預設值建立對應的資源，其中某個欄位會用於<strong>記錄原始的檔案內容(用紅色的F標示)</strong>，剩餘的部分(如 G ~ K)則是 K8s 根據本身的預設值自動建立資源。</p>
<p><strong>圖片下半部分:</strong></p>
<p>若對原始定義的 Config yaml 內容作修改(如圖中橘色的 B ~ C)，經第二次 <code>apply</code> 後，K8s 會根據紀錄在F欄位的物件，將修改後的物件與原始存在K8s裡的物件進行比對。</p>
<p>如此一來，使用這變得方便許多，不需要取得完整的 yaml 檔內容(包含K8s 預設自動建立好的資源)，即可針對變動的檔案內容更新 K8s 裡的資源，實務上都採此法更新 K8s 資源，故 <code>apply</code> 與 <code>create</code> 的含意不同。</p>
<blockquote>
<p><code>kubectl create</code> 表創造資源，而 <code>kubectl apply</code> 則是維護資源狀態，希望狀態是一致的。</p>
</blockquote>
<h3 id="範例"><a href="#範例" class="headerlink" title="範例"></a>範例</h3><p>將前面 <code>create</code> 的 Nginx 範例改用 <code>apply</code> 來執行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl apply -f pod.yaml<br></code></pre></td></tr></table></figure>
<p><strong>output</strong></p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">pod/myapp-pod-nginx-<span class="hljs-built_in">demo</span> created<br></code></pre></td></tr></table></figure>
<p>把 image 改為 <code>httpd</code> ，將部署的服務改為 Apache Server</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">Pod</span> <span class="hljs-comment"># 指定為 Pod</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">myapp-pod-nginx-demo</span><br>  <span class="hljs-attr">labels:</span><br>    <span class="hljs-attr">app:</span> <span class="hljs-string">myapp-pod-nginx-demo</span> <span class="hljs-comment"># 定義好 Label 用於辨認</span><br><span class="hljs-attr">spec:</span><br>  <span class="hljs-attr">containers:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">myapp-pod-nginx-demo</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">httpd</span> <span class="hljs-comment"># 從 nginx 改為 httpd</span><br>    <span class="hljs-attr">resources:</span> <span class="hljs-comment"># 給定索取資源的上限</span><br>      <span class="hljs-attr">limits:</span><br>        <span class="hljs-attr">cpu:</span> <span class="hljs-string">200m</span><br>        <span class="hljs-attr">memory:</span> <span class="hljs-string">200Mi</span><br>      <span class="hljs-attr">requests:</span><br>          <span class="hljs-attr">cpu:</span> <span class="hljs-string">100m</span><br>          <span class="hljs-attr">memory:</span> <span class="hljs-string">64Mi</span><br></code></pre></td></tr></table></figure>
<p>在 <code>apply</code> 之前，可以先透過 <code>diff</code> 指令來觀察資源變化</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl diff -f pod.yaml<br></code></pre></td></tr></table></figure>
<p>或是透過 <code>get</code> 指令加上參數 <code>-o yaml</code> 以 <code>yaml</code> 形式列出檔案內容</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl get -f pod.yaml -o yaml<br></code></pre></td></tr></table></figure>
<p>觀察一下 <code>metadata</code> 裡的 <code>annotations</code> 區塊，可發現有個欄位名稱: <strong>kubectl.kubernetes.io/last-applied-configuration</strong>，此欄位用於記錄先前的使用檔案內容</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">annotations:</span><br>    <span class="hljs-attr">kubectl.kubernetes.io/last-applied-configuration:</span> <span class="hljs-string">|</span><br>      &#123;<span class="hljs-string">&quot;apiVersion&quot;</span><span class="hljs-string">:&quot;v1&quot;</span>,<span class="hljs-string">&quot;kind&quot;</span><span class="hljs-string">:&quot;Pod&quot;</span>,<span class="hljs-string">&quot;metadata&quot;</span><span class="hljs-string">:</span>&#123;<span class="hljs-string">&quot;annotations&quot;</span><span class="hljs-string">:</span>&#123;&#125;,<span class="hljs-string">&quot;labels&quot;</span><span class="hljs-string">:</span>&#123;<span class="hljs-string">&quot;app&quot;</span><span class="hljs-string">:&quot;myapp-pod-nginx-demo&quot;</span>&#125;,<span class="hljs-string">&quot;name&quot;</span><span class="hljs-string">:&quot;myapp-pod-nginx-demo&quot;</span>,<span class="hljs-string">&quot;namespace&quot;</span><span class="hljs-string">:&quot;xxxx&quot;</span>&#125;,<span class="hljs-string">&quot;spec&quot;</span><span class="hljs-string">:</span>&#123;<span class="hljs-string">&quot;containers&quot;</span><span class="hljs-string">:</span>[&#123;<span class="hljs-string">&quot;image&quot;</span><span class="hljs-string">:&quot;nginx&quot;</span>,<span class="hljs-string">&quot;name&quot;</span><span class="hljs-string">:&quot;myapp-pod-nginx-demo&quot;</span>,<span class="hljs-string">&quot;resources&quot;</span><span class="hljs-string">:</span>&#123;<span class="hljs-string">&quot;limits&quot;</span><span class="hljs-string">:</span>&#123;<span class="hljs-string">&quot;cpu&quot;</span><span class="hljs-string">:&quot;200m&quot;</span>,<span class="hljs-string">&quot;memory&quot;</span><span class="hljs-string">:&quot;200Mi&quot;</span>&#125;,<span class="hljs-string">&quot;requests&quot;</span><span class="hljs-string">:</span>&#123;<span class="hljs-string">&quot;cpu&quot;</span><span class="hljs-string">:&quot;100m&quot;</span>,<span class="hljs-string">&quot;memory&quot;</span><span class="hljs-string">:&quot;64Mi&quot;</span>&#125;&#125;&#125;]&#125;&#125;<br></code></pre></td></tr></table></figure>
<p>重新 <code>apply</code> 一次</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl apply -f pod.yaml<br></code></pre></td></tr></table></figure>
<p><strong>output</strong></p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">pod/myapp-pod-nginx-<span class="hljs-built_in">demo</span> configured<br></code></pre></td></tr></table></figure>
<p>接著用 <code>get</code> 再次檢查<code>annotations</code> 區塊的 <strong>kubectl.kubernetes.io/last-applied-configuration</strong> 欄位:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">annotations:</span><br>    <span class="hljs-attr">kubectl.kubernetes.io/last-applied-configuration:</span> <span class="hljs-string">|</span><br>      &#123;<span class="hljs-string">&quot;apiVersion&quot;</span><span class="hljs-string">:&quot;v1&quot;</span>,<span class="hljs-string">&quot;kind&quot;</span><span class="hljs-string">:&quot;Pod&quot;</span>,<span class="hljs-string">&quot;metadata&quot;</span><span class="hljs-string">:</span>&#123;<span class="hljs-string">&quot;annotations&quot;</span><span class="hljs-string">:</span>&#123;&#125;,<span class="hljs-string">&quot;labels&quot;</span><span class="hljs-string">:</span>&#123;<span class="hljs-string">&quot;app&quot;</span><span class="hljs-string">:&quot;myapp-pod-nginx-demo&quot;</span>&#125;,<span class="hljs-string">&quot;name&quot;</span><span class="hljs-string">:&quot;myapp-pod-nginx-demo&quot;</span>,<span class="hljs-string">&quot;namespace&quot;</span><span class="hljs-string">:&quot;xxxx&quot;</span>&#125;,<span class="hljs-string">&quot;spec&quot;</span><span class="hljs-string">:</span>&#123;<span class="hljs-string">&quot;containers&quot;</span><span class="hljs-string">:</span>[&#123;<span class="hljs-string">&quot;image&quot;</span><span class="hljs-string">:&quot;httpd&quot;</span>,<span class="hljs-string">&quot;name&quot;</span><span class="hljs-string">:&quot;myapp-pod-nginx-demo&quot;</span>,<span class="hljs-string">&quot;resources&quot;</span><span class="hljs-string">:</span>&#123;<span class="hljs-string">&quot;limits&quot;</span><span class="hljs-string">:</span>&#123;<span class="hljs-string">&quot;cpu&quot;</span><span class="hljs-string">:&quot;200m&quot;</span>,<span class="hljs-string">&quot;memory&quot;</span><span class="hljs-string">:&quot;200Mi&quot;</span>&#125;,<span class="hljs-string">&quot;requests&quot;</span><span class="hljs-string">:</span>&#123;<span class="hljs-string">&quot;cpu&quot;</span><span class="hljs-string">:&quot;100m&quot;</span>,<span class="hljs-string">&quot;memory&quot;</span><span class="hljs-string">:&quot;64Mi&quot;</span>&#125;&#125;&#125;]&#125;&#125;<br></code></pre></td></tr></table></figure>
<p>確認 image 資訊從 <code>nginx</code> 更新為 <code>httpd</code>。</p>
<p>當然也可以透過 <code>describe</code> 的方式來查看該 Pod 當前運行的 image 是哪個</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">kubectl describe pod myapp-pod-nginx-demo<br></code></pre></td></tr></table></figure>

<p>經過上述幾個範例實作後，大部分的情況下都會藉由 <code>apply</code> 的方式來維護描述 K8s 資源的檔案。另外列出使用聲明式管理的優劣<br><strong>優:</strong></p>
<ul>
<li>直接對物件作修改，易於管理資源變化(可搭配 git 做版控)</li>
<li>支援整個資料夾</li>
</ul>
<p><strong>劣:</strong><br>在開發環境較為缺乏彈性(並非所有環境都能拿到最初的 <code>yaml</code> 檔案做 <code>apply</code>)</p>
<h3 id="總結聲明式管理"><a href="#總結聲明式管理" class="headerlink" title="總結聲明式管理"></a>總結聲明式管理</h3><p>透過檔案的方式維護資源(下載、更新資源)，有效搭配版控追蹤每次修改的紀錄，能更有系統地除錯、追蹤及部署。</p>
<blockquote>
<p>更多細節可查閱<a target="_blank" rel="noopener" href="https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/pod-v1/">文件1</a> or <a target="_blank" rel="noopener" href="https://v1-17.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.17/#pod-v1-core">文件2</a>，再根據自身需求進行調整</p>
</blockquote>
<h2 id="Pod-Controller-Workload-Controller"><a href="#Pod-Controller-Workload-Controller" class="headerlink" title="Pod Controller (Workload Controller)"></a>Pod Controller (Workload Controller)</h2><p>Pod 底下擁有多種類型的 Controller，每種 Controller 都有合適的應用場景:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/">ReplicaSet</a>: 管理多個 Pod 的副本</li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Deployment</a>: 提供聲明式的方法來更新 Pods</li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/">Daemonset</a>: 確保每一個 node 上都會有一個指定的 Pod 來運行特定的工作</li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/">StatefulSet</a>: 處理有狀態 Container</li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/workloads/controllers/job/">Job</a>: 在特定時間完成批次工作</li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/">CronJob</a>: 定期排程工作</li>
</ul>
<p>之後會針對 Pod 底下不同的 Controller 分篇做紀錄，本篇只有先單純列出 Pod 底下不同類型的 Controller</p>
<h1 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h1><p>本篇記錄如何透過 Kubectl 來對 Pod 元件進行常見的操作，並比較 <strong>命令式管理與聲明式管理</strong> 兩者的差異，最後透過幾個範例實際演練，下一篇會針對 Pod 底下的 Controller - <code>ReplicaSet</code> 做討論。</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/workloads/controllers/">Workload Resources</a></li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/workloads/pods/">Kubernetes Documentation - Pod</a></li>
<li><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10193232">在 Minikube 上跑起你的 Docker Containers - Pod &amp; kubectl 常用指令</a></li>
</ul>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="../../../../../../tags/Kubernetes/">Kubernetes</a><a class="link-muted mr-2" rel="tag" href="../../../../../../tags/K8s/">K8s</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="../../../../14/DevOps/K8s/%5BKubernetes%5D%20Kubernetes%20%E5%9F%BA%E7%A4%8E(%E4%B8%89)%20Pod%20Controller%20-%20ReplicaSet/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">[Kubernetes] Kubernetes 基礎(三) Pod Controller - ReplicaSet</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="../../../../07/DevOps/K8s/%5BKubernetes%5D%20Kubernetes%20%E5%9F%BA%E7%A4%8E(%E3%84%A7)%20%E6%9E%B6%E6%A7%8B%E5%8F%8A%E5%85%83%E4%BB%B6/"><span class="level-item">[Kubernetes] Kubernetes 基礎(ㄧ) 架構及元件</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "d272a197c2fb8b5c1ad9ea8f4223dc7e",
            repo: "ChenTsungYu.github.io",
            owner: "ChenTsungYu",
            clientID: "7913190f1a943b88e276",
            clientSecret: "8c54a86c8fe06b650efe932eb53bc421ddf84773",
            admin: ["ChenTsungYu"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 20,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="../../../../../../img/avatar1.jpg" alt="Tsung Yu Chen"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Tsung Yu Chen</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Taiwan</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="../../../../../../archives"><p class="title">109</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="../../../../../../categories"><p class="title">8</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="../../../../../../tags"><p class="title">49</p></a></div></div></nav><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="../../../../../../https:/github.com/ChenTsungYu"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="../../../../../../https:/www.facebook.com/zong.y.r/"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="LinkedIn" href="../../../../../../https:/www.linkedin.com/in/tom-chen-1012/"><i class="fab fa-linkedin-in"></i></a></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="../../../../../../categories/Backend/"><span class="level-start"><span class="level-item">Backend</span></span><span class="level-end"><span class="level-item tag">47</span></span></a></li><li><a class="level is-mobile" href="../../../../../../categories/Cloud/"><span class="level-start"><span class="level-item">Cloud</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="../../../../../../categories/Conference/"><span class="level-start"><span class="level-item">Conference</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="../../../../../../categories/DevOps/"><span class="level-start"><span class="level-item">DevOps</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile" href="../../../../../../categories/Frontend/"><span class="level-start"><span class="level-item">Frontend</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><li><a class="level is-mobile" href="../../../../../../categories/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="../../../../../../categories/OS/"><span class="level-start"><span class="level-item">OS</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="../../../../../../categories/Tool/"><span class="level-start"><span class="level-item">Tool</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="../../../../../../archives/2022/11/"><span class="level-start"><span class="level-item">November 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2022/06/"><span class="level-start"><span class="level-item">June 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2021/10/"><span class="level-start"><span class="level-item">October 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2021/09/"><span class="level-start"><span class="level-item">September 2021</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2021/06/"><span class="level-start"><span class="level-item">June 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2021/04/"><span class="level-start"><span class="level-item">April 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2021/03/"><span class="level-start"><span class="level-item">March 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2020/07/"><span class="level-start"><span class="level-item">July 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2019/08/"><span class="level-start"><span class="level-item">August 2019</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="../../../../../../archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">25</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="../../../../../../tags/AWS/"><span class="tag">AWS</span><span class="tag">14</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Ansible/"><span class="tag">Ansible</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/CICD/"><span class="tag">CICD</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Canvas/"><span class="tag">Canvas</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Certbot/"><span class="tag">Certbot</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Conference/"><span class="tag">Conference</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Cookie/"><span class="tag">Cookie</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Css/"><span class="tag">Css</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Database/"><span class="tag">Database</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/DevOps/"><span class="tag">DevOps</span><span class="tag">16</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Django/"><span class="tag">Django</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Docker/"><span class="tag">Docker</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/ELK/"><span class="tag">ELK</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Elasticsearch/"><span class="tag">Elasticsearch</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Github/"><span class="tag">Github</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/GithubAction/"><span class="tag">GithubAction</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Go/"><span class="tag">Go</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/GoogleMap/"><span class="tag">GoogleMap</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/JSDC/"><span class="tag">JSDC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/JavaScript/"><span class="tag">JavaScript</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/K8s/"><span class="tag">K8s</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Kibana/"><span class="tag">Kibana</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Kubernetes/"><span class="tag">Kubernetes</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Linux/"><span class="tag">Linux</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Mac/"><span class="tag">Mac</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/MongoDB/"><span class="tag">MongoDB</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/MySQL/"><span class="tag">MySQL</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Network/"><span class="tag">Network</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/NoSQL/"><span class="tag">NoSQL</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/OOP/"><span class="tag">OOP</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/OS/"><span class="tag">OS</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Pandas/"><span class="tag">Pandas</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Postgres/"><span class="tag">Postgres</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Project/"><span class="tag">Project</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Proxy/"><span class="tag">Proxy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Python/"><span class="tag">Python</span><span class="tag">26</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Redis/"><span class="tag">Redis</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/SQL-Server/"><span class="tag">SQL Server</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/SSL/"><span class="tag">SSL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Session/"><span class="tag">Session</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Terraform/"><span class="tag">Terraform</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Ubuntu/"><span class="tag">Ubuntu</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/VSCode/"><span class="tag">VSCode</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Vue/"><span class="tag">Vue</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/WebScraping/"><span class="tag">WebScraping</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/WebSocket/"><span class="tag">WebSocket</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/Webhook/"><span class="tag">Webhook</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/w3HexSchool/"><span class="tag">w3HexSchool</span><span class="tag">20</span></a></div><div class="control"><a class="tags has-addons" href="../../../../../../tags/%E8%A8%88%E6%A6%82/"><span class="tag">計概</span><span class="tag">1</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#前言"><span class="level-left"><span class="level-item">1</span><span class="level-item">前言</span></span></a></li><li><a class="level is-mobile" href="#Kubectl"><span class="level-left"><span class="level-item">2</span><span class="level-item">Kubectl</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#命名空間-Namespace"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">命名空間 (Namespace)</span></span></a></li><li><a class="level is-mobile" href="#自動補全-Completion"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">自動補全 (Completion)</span></span></a></li><li><a class="level is-mobile" href="#讀取-Kubernetes-資源的相關指令-Get"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">讀取 Kubernetes 資源的相關指令 - Get</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#讀取某個-NameSpace-下的所有-Pods-資訊"><span class="level-left"><span class="level-item">2.3.1</span><span class="level-item">讀取某個 NameSpace 下的所有 Pods 資訊</span></span></a></li><li><a class="level is-mobile" href="#讀取某個-NameSpace-下特定的-Pods-資訊"><span class="level-left"><span class="level-item">2.3.2</span><span class="level-item">讀取某個 NameSpace 下特定的 Pods 資訊</span></span></a></li><li><a class="level is-mobile" href="#監聽-Pod-Watch"><span class="level-left"><span class="level-item">2.3.3</span><span class="level-item">監聽 Pod - Watch</span></span></a></li></ul></li><li><a class="level is-mobile" href="#讀取-Kubernetes-資源的相關指令-Describe"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">讀取 Kubernetes 資源的相關指令 - Describe</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Kubeconfig-的管理"><span class="level-left"><span class="level-item">3</span><span class="level-item">Kubeconfig 的管理</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Context"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">Context</span></span></a></li><li><a class="level is-mobile" href="#Kubeconfig-範例格式"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">Kubeconfig 範例格式</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Kubeconfig-相關指令"><span class="level-left"><span class="level-item">4</span><span class="level-item">Kubeconfig 相關指令</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#對-Pod-操作-Imperative-Management-命令式管理"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">對 Pod 操作 (Imperative Management; 命令式管理)</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#建立-amp-查看-Pod"><span class="level-left"><span class="level-item">4.1.1</span><span class="level-item">建立&amp;查看 Pod</span></span></a></li><li><a class="level is-mobile" href="#刪除-Pod"><span class="level-left"><span class="level-item">4.1.2</span><span class="level-item">刪除 Pod</span></span></a></li><li><a class="level is-mobile" href="#編輯-Pod"><span class="level-left"><span class="level-item">4.1.3</span><span class="level-item">編輯 Pod</span></span></a></li></ul></li><li><a class="level is-mobile" href="#對-Pod-操作-Declarative-Management-聲明式管理"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">對 Pod 操作 (Declarative Management; 聲明式管理)</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#kubectl-apply"><span class="level-left"><span class="level-item">4.2.1</span><span class="level-item">kubectl apply</span></span></a></li><li><a class="level is-mobile" href="#kubectl-diff"><span class="level-left"><span class="level-item">4.2.2</span><span class="level-item">kubectl diff</span></span></a></li><li><a class="level is-mobile" href="#Work-Flow"><span class="level-left"><span class="level-item">4.2.3</span><span class="level-item">Work Flow</span></span></a></li><li><a class="level is-mobile" href="#範例"><span class="level-left"><span class="level-item">4.2.4</span><span class="level-item">範例</span></span></a></li><li><a class="level is-mobile" href="#總結聲明式管理"><span class="level-left"><span class="level-item">4.2.5</span><span class="level-item">總結聲明式管理</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Pod-Controller-Workload-Controller"><span class="level-left"><span class="level-item">4.3</span><span class="level-item">Pod Controller (Workload Controller)</span></span></a></li></ul></li><li><a class="level is-mobile" href="#總結"><span class="level-left"><span class="level-item">5</span><span class="level-item">總結</span></span></a></li><li><a class="level is-mobile" href="#Reference"><span class="level-left"><span class="level-item">6</span><span class="level-item">Reference</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="../../../../../../js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-11-27T08:00:19.787Z">2022/11/27</time></p><p class="title"><a href="../../../../../../2022/11/27/DevOps/CICD/GitHub%20Action%20OIDC/">[Github Action] 整合 AWS OIDC 進行 CI/CD 安全強化</a></p><p class="categories"><a href="../../../../../../categories/DevOps/">DevOps</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-06-29T05:23:10.000Z">2022/06/29</time></p><p class="title"><a href="../../../../../../2022/06/29/Database/Index/">[Postgres] 資料庫的索引(Index)</a></p><p class="categories"><a href="../../../../../../categories/Backend/">Backend</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-06-20T05:23:10.000Z">2022/06/20</time></p><p class="title"><a href="../../../../../../2022/06/20/Database/%E8%B3%87%E6%96%99%E5%BA%AB%E5%A6%82%E4%BD%95%E5%AD%98%E6%94%BE%E8%B3%87%E6%96%99/">[Postgres] 資料庫裡的儲存概念</a></p><p class="categories"><a href="../../../../../../categories/Backend/">Backend</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-15T05:23:10.000Z">2022/01/15</time></p><p class="title"><a href="../../../../../../2022/01/15/Database/Redis/%5BBackend%5D%20%E6%8F%90%E9%AB%98%20Redis%20%E5%9F%B7%E8%A1%8C%E6%95%88%E7%8E%87%E7%9A%84%E6%96%B9%E6%B3%95%20-%20Pipeline/">[Redis] 提高 Redis 執行效率的方法 - Pipeline</a></p><p class="categories"><a href="../../../../../../categories/Backend/">Backend</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-11T05:23:10.000Z">2022/01/11</time></p><p class="title"><a href="../../../../../../2022/01/11/Database/Redis/%5BBackend%5D%20Redis%20-%20Transction/">[Redis] Redis - Transaction</a></p><p class="categories"><a href="../../../../../../categories/Backend/">Backend</a></p></div></article></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="../../../../../../index.html"><img src="../../../../../../img/dragon_blue.png" alt="Tom&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2022 Tsung Yu Chen</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="../../../../../../https:/creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="../../../../../../https:/creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="../../../../../../https:/github.com/ChenTsungYu"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="../../../../../../js/column.js"></script><script src="../../../../../../js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="../../../../../../js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="../../../../../../js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="../../../../../../js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"../../../../../../content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>