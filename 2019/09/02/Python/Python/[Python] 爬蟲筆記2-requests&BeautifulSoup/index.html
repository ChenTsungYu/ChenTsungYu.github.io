<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Archives - Tom&#039;s Blog</title><link rel="manifest" href="../../../../../../manifest.json"><meta name="application-name" content="Tom&#039;s Blog"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Tom&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="前言繼上篇筆記之後，本篇主要紀錄我常用的爬蟲工具：requests、BeautifulSoup這兩個模組。 所需先備知識-了解網站請求向網站發請求時，GET與POST是常見的HTTP Method，爬蟲大多採用這兩種方法。 安裝requests和bs412pip install bs4pip install requests 引入模組12import requestsfrom bs4 impor"><meta property="og:type" content="blog"><meta property="og:title" content="[Python] 爬蟲筆記2-requests&amp;BeautifulSoup"><meta property="og:url" content="https://github.com/ChenTsungYu/2019/09/02/Python/Python/[Python]%20%E7%88%AC%E8%9F%B2%E7%AD%86%E8%A8%982-requests&amp;BeautifulSoup/"><meta property="og:site_name" content="Tom&#039;s Blog"><meta property="og:description" content="前言繼上篇筆記之後，本篇主要紀錄我常用的爬蟲工具：requests、BeautifulSoup這兩個模組。 所需先備知識-了解網站請求向網站發請求時，GET與POST是常見的HTTP Method，爬蟲大多採用這兩種方法。 安裝requests和bs412pip install bs4pip install requests 引入模組12import requestsfrom bs4 impor"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://i.imgur.com/m9w1CEs.png"><meta property="article:published_time" content="2019-09-02T12:23:10.000Z"><meta property="article:modified_time" content="2021-09-28T13:05:55.537Z"><meta property="article:author" content="Tsung Yu Chen"><meta property="article:tag" content="Python"><meta property="article:tag" content="WebScraping"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://i.imgur.com/m9w1CEs.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://github.com/ChenTsungYu/2019/09/02/Python/Python/[Python]%20%E7%88%AC%E8%9F%B2%E7%AD%86%E8%A8%982-requests&BeautifulSoup/"},"headline":"Tom's Blog","image":["https://i.imgur.com/m9w1CEs.png"],"datePublished":"2019-09-02T12:23:10.000Z","dateModified":"2021-09-28T13:05:55.537Z","author":{"@type":"Person","name":"Tsung Yu Chen"},"description":"前言繼上篇筆記之後，本篇主要紀錄我常用的爬蟲工具：requests、BeautifulSoup這兩個模組。 所需先備知識-了解網站請求向網站發請求時，GET與POST是常見的HTTP Method，爬蟲大多採用這兩種方法。 安裝requests和bs412pip install bs4pip install requests 引入模組12import requestsfrom bs4 impor"}</script><link rel="canonical" href="https://github.com/ChenTsungYu/2019/09/02/Python/Python/[Python]%20%E7%88%AC%E8%9F%B2%E7%AD%86%E8%A8%982-requests&amp;BeautifulSoup/"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="../../../../../../css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.2"></head><body class="is-2-column"><script type="text/javascript" src="/js/imaegoo/night.js"></script><canvas id="universe"></canvas><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="../../../../../../index.html"><img class="logo-img" src="../../../../../../img/dragon_blue.png" alt="Tom&#039;s Blog" height="28"><img class="logo-img-dark" src="../../../../../../img/dragon_red.png" alt="Tom&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="../../../../../../index.html">Home</a><a class="navbar-item" href="../../../../../../archives">Archives</a><a class="navbar-item" href="../../../../../../categories">Categories</a><a class="navbar-item" href="../../../../../../tags">Tags</a><a class="navbar-item" href="../../../../../../about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ChenTsungYu"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-7-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-09-02T12:23:10.000Z" title="9/2/2019, 8:23:10 PM">2019/09/02</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-09-28T13:05:55.537Z" title="9/28/2021, 9:05:55 PM">2021/09/28</time></span><span class="level-item"><a class="link-muted" href="../../../../../../categories/Backend/">Backend</a></span><span class="level-item">13 minutes read (About 1944 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">[Python] 爬蟲筆記2-requests&amp;BeautifulSoup</h1><div class="content"><!-- toc -->
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>繼上篇筆記之後，本篇主要紀錄我常用的爬蟲工具：<code>requests</code>、<code>BeautifulSoup</code>這兩個模組。</p>
<h1 id="所需先備知識-了解網站請求"><a href="#所需先備知識-了解網站請求" class="headerlink" title="所需先備知識-了解網站請求"></a>所需先備知識-了解網站請求</h1><p>向網站發請求時，GET與POST是常見的HTTP Method，爬蟲大多採用這兩種<a target="_blank" rel="noopener" href="https://blog.toright.com/posts/1203/%E6%B7%BA%E8%AB%87-http-method%EF%BC%9A%E8%A1%A8%E5%96%AE%E4%B8%AD%E7%9A%84-get-%E8%88%87-post-%E6%9C%89%E4%BB%80%E9%BA%BC%E5%B7%AE%E5%88%A5%EF%BC%9F.html">方法</a>。</p>
<h2 id="安裝requests和bs4"><a href="#安裝requests和bs4" class="headerlink" title="安裝requests和bs4"></a>安裝requests和bs4</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">pip install bs4<br>pip install requests<br></code></pre></td></tr></table></figure>
<h2 id="引入模組"><a href="#引入模組" class="headerlink" title="引入模組"></a>引入模組</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br></code></pre></td></tr></table></figure>
<span id="more"></span> 
<h1 id="requests"><a href="#requests" class="headerlink" title="requests"></a>requests</h1><p>requests模組可以讀取網站的原始碼，再利用正規表達式取得目標資料。</p>
<h2 id="GET-Method"><a href="#GET-Method" class="headerlink" title="GET Method"></a>GET Method</h2><p>假設今天要抓取PTT的<a target="_blank" rel="noopener" href="https://www.ptt.cc/bbs/NBA/index.html">NBA版</a>，讀取網頁的方法會是:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">requests.get(<span class="hljs-string">&quot;目標網址&quot;</span>, headers=你設置的header)<br></code></pre></td></tr></table></figure>
<p>範例:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">header=&#123;<span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0&#x27;</span>&#125;<br>url = requests.get(<span class="hljs-string">&quot;https://www.ptt.cc/bbs/NBA/index.html&quot;</span>, headers=header)<br></code></pre></td></tr></table></figure>
<p><strong>requests相關知識:</strong></p>
<ol>
<li>http狀態碼: <code>resp.status_code</code><br>http狀態碼(status code)，用於表示向網站請求的狀態。</li>
</ol>
<ul>
<li>通常2開頭為請求成功</li>
<li>開頭為4為請求失敗，表示<strong>Client端</strong>錯誤</li>
<li>開頭為5為請求失敗，表示<strong>Server端</strong>錯誤<br>可以依照http狀態碼來排查問題，更詳細的狀態說明可以看<a target="_blank" rel="noopener" href="https://poychang.github.io/http-status-code/">這篇</a>。</li>
</ul>
<ol start="2">
<li>查看網頁編碼: <code>url.encoding</code><br>有時候解析下來的網頁會有文字編碼問題，python3內所有的文字都是 <code>unicode</code>類型的<code>str</code>，可以透過encoding的方式查看編碼，也可以改變網頁編碼，如:<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(url.encoding) <span class="hljs-comment"># utf-8</span><br><br><span class="hljs-comment"># 改變編碼方式</span><br>url.encoding = <span class="hljs-string">&#x27;big5&#x27;</span><br><span class="hljs-built_in">print</span>(url.encoding) <span class="hljs-comment"># big5</span><br></code></pre></td></tr></table></figure></li>
<li>解析網頁內容<br>確定網頁請求成功後(狀態碼為200)，接著進行網頁內容解析，獲取的資料大部分會用上面兩種型式儲存:</li>
</ol>
<ul>
<li>text: 返回的是 Unicode型態的資料，常用於字串。</li>
<li>content: 返回的是bytes型態的資料，常用於圖片、文件。</li>
</ul>
<ol start="4">
<li>在網址列加上<a target="_blank" rel="noopener" href="https://nkust.gitbook.io/python/qu-ji-qiao">查詢參數(Query String)</a><br>有時會在發GET請求時，在網址列加上查詢的參數，可採自訂payload(dic資料型態)的方法，GET以params為參數，將自訂的參數值assign給params:<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">payload = &#123;<span class="hljs-string">&#x27;key1&#x27;</span>: <span class="hljs-string">&#x27;value1&#x27;</span>, <span class="hljs-string">&#x27;key2&#x27;</span>: <span class="hljs-string">&#x27;value2&#x27;</span>&#125;<br>requests.get(<span class="hljs-string">&quot;目標網址&quot;</span>, params=payload)<br></code></pre></td></tr></table></figure>
以<a target="_blank" rel="noopener" href="https://tw.stock.yahoo.com/news_list/url/d/e/N1.html?q=&pg=1">雅虎股市新聞</a>為例，參數<code>pg</code>後面挾帶的數值表示頁數:<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">payload = &#123;<span class="hljs-string">&#x27;q&#x27;</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;pg&#x27;</span>: <span class="hljs-string">&#x27;2&#x27;</span>&#125;<br>page = requests.get(<span class="hljs-string">&quot;https://tw.stock.yahoo.com/news_list/url/d/e/N1.html&quot;</span>, headers=header, params=payload)<br><span class="hljs-built_in">print</span>(page.url)<br><span class="hljs-comment"># 結果: https://tw.stock.yahoo.com/news_list/url/d/e/N1.html?q=&amp;pg=1</span><br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="POST-Method"><a href="#POST-Method" class="headerlink" title="POST Method"></a>POST Method</h2><p>相較於GET，POST請求的資料通常都是網頁讓使用者填表單時會採用的方法。POST以data為參數，將自訂的參數值assign給data:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">payload = &#123;<span class="hljs-string">&#x27;key1&#x27;</span>: <span class="hljs-string">&#x27;value1&#x27;</span>, <span class="hljs-string">&#x27;key2&#x27;</span>: <span class="hljs-string">&#x27;value2&#x27;</span>&#125;<br>requests.post(<span class="hljs-string">&quot;目標網址&quot;</span>, data=payload)<br></code></pre></td></tr></table></figure>
<p>範例:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">payload = &#123;<span class="hljs-string">&#x27;key1&#x27;</span>: <span class="hljs-string">&#x27;value1&#x27;</span>, <span class="hljs-string">&#x27;key2&#x27;</span>: <span class="hljs-string">&#x27;value2&#x27;</span>&#125;<br>page = requests.post(<span class="hljs-string">&quot;http://httpbin.org/post&quot;</span>, headers=header,data=page)<br><span class="hljs-built_in">print</span>(page.text)<br></code></pre></td></tr></table></figure>

<h2 id="Session-Method"><a href="#Session-Method" class="headerlink" title="Session Method"></a>Session Method</h2><p>有時使用者(Client)造訪網站時，網站(server)為了要辨識使用者身份，會發一個憑證給訪問者，憑證若<strong>儲存在Client端稱作cookie</strong>，<strong>存在Server端稱作Session</strong>，兩者常用於紀錄登入者資訊，這時可用Session方法紀錄cookie訊息。</p>
<h3 id="實作"><a href="#實作" class="headerlink" title="實作:"></a>實作:</h3><p>假設今天目標為PTT的八卦版，在第一次訪問時會導向另一個頁面先確定使用者是否超過18歲，以網路爬蟲來說，必須先經由認證的行為來取得合法身份，使用者資訊會夾雜在session裡面。<br>在<strong>我同意</strong>的按鈕上點擊右鍵打開開發者工具觀察元素，可以發現預設值為<strong>yes</strong>，並以<code>POST</code>的形式傳送資料，</p>
<p><img src="https://i.imgur.com/m9w1CEs.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>payload = &#123;<br>   <span class="hljs-string">&#x27;from&#x27;</span>: <span class="hljs-string">&#x27;https://www.ptt.cc/bbs/Gossiping/index.html&#x27;</span>,<br> <span class="hljs-string">&#x27;yes&#x27;</span>: <span class="hljs-string">&#x27;yes&#x27;</span><br> &#125;<br>headers = &#123;<br> <span class="hljs-string">&#x27;user-agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0&#x27;</span><br>&#125;<br>rs = requests.Session()<br>rs.post(<span class="hljs-string">&#x27;https://www.ptt.cc/ask/over18&#x27;</span>, data=payload, headers=headers)<br>res = rs.get(<span class="hljs-string">&#x27;https://www.ptt.cc/bbs/Gossiping/index.html&#x27;</span>, headers=headers)<br><br><span class="hljs-built_in">print</span>(res.text)<br></code></pre></td></tr></table></figure>
<p>上述範例程式碼中，<code>from</code>表來源網頁，<code>yes</code>為按鈕的預設值。</p>
<h1 id="BeautifulSoup"><a href="#BeautifulSoup" class="headerlink" title="BeautifulSoup"></a>BeautifulSoup</h1><p>通常解析出來的網頁結構都比較複雜，要擷取特定資料需要其他工具來協助我們，這時<code>BeautifulSoup</code>就派上用場了，當然除了<code>BeautifulSoup</code>之外，常用的工具還包含<code>xpath</code>、<code>正規表示式(re)</code>等方法，本篇先記錄<code>BeautifulSoup</code>。<br>延續上一段未完成的PTT八卦版程式碼，如果要取得多個標題文章，可以用下面這段完整的程式碼:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># PTT八卦版爬蟲</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br>payload = &#123;<br>   <span class="hljs-string">&#x27;from&#x27;</span>: <span class="hljs-string">&#x27;https://www.ptt.cc/bbs/Gossiping/index.html&#x27;</span>,<br> <span class="hljs-string">&#x27;yes&#x27;</span>: <span class="hljs-string">&#x27;yes&#x27;</span><br> &#125;<br>headers = &#123;<br> <span class="hljs-string">&#x27;user-agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0&#x27;</span><br>&#125;<br>rs = requests.Session()<br>rs.post(<span class="hljs-string">&#x27;https://www.ptt.cc/ask/over18&#x27;</span>, data=payload, headers=headers)<br>res = rs.get(<span class="hljs-string">&#x27;https://www.ptt.cc/bbs/Gossiping/index.html&#x27;</span>, headers=headers)<br>soup = BeautifulSoup(res.text, <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br>items = soup.select(<span class="hljs-string">&#x27;.r-ent&#x27;</span>)<br><span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> items:<br>    <span class="hljs-built_in">print</span>(item.select(<span class="hljs-string">&#x27;.date&#x27;</span>)[<span class="hljs-number">0</span>].text, item.select(<span class="hljs-string">&#x27;.author&#x27;</span>)[<span class="hljs-number">0</span>].text, item.select(<span class="hljs-string">&#x27;.title&#x27;</span>)[<span class="hljs-number">0</span>].text)<br></code></pre></td></tr></table></figure>
<p><code>BeautifulSoup(res.text, &#39;html.parser&#39;)</code>採用解析器:<code>html.parser</code>是Python內建的，除了<code>html.parser</code>外，還支援<code>lxml</code>，更多解析器及比較可參考<a target="_blank" rel="noopener" href="https://beautifulsoup.readthedocs.io/zh_CN/v4.4.0/">這篇文章</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">soup.prettify()<br></code></pre></td></tr></table></figure>
<p>上述方法可印出完整的HTML結構(排版後)。<br>接著觀察網頁結構的HTML標籤</p>
<h2 id="常用的方法"><a href="#常用的方法" class="headerlink" title="常用的方法"></a>常用的方法</h2><h3 id="find-、find-all"><a href="#find-、find-all" class="headerlink" title="find()、find_all()"></a>find()、find_all()</h3><ul>
<li>find(“標籤名稱”): 回傳<strong>第一個</strong>符合指定的標籤內容，找不到則回傳<code>None</code>。</li>
<li>find_all(“標籤名稱”): 回傳<strong>多個</strong>符合指定的標籤內容，是一個<strong>list結構</strong>，找不到則回傳空的list。</li>
</ul>
<h4 id="獲取標籤內容"><a href="#獲取標籤內容" class="headerlink" title="獲取標籤內容"></a>獲取標籤內容</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-comment">## 範例</span><br>soup.find(<span class="hljs-string">&#x27;p&#x27;</span>).text <span class="hljs-comment"># 印出第一個p標籤</span><br>soup.find_all(<span class="hljs-string">&#x27;p&#x27;</span>)[<span class="hljs-number">0</span>].get_text() <span class="hljs-comment"># 印出第一個p標籤的文字內容</span><br><br>soup.find_all(class_=<span class="hljs-string">&quot;outer-text&quot;</span>) <span class="hljs-comment"># 取得有class得tag</span><br>soup.find(<span class="hljs-built_in">id</span>=<span class="hljs-string">&#x27;link2&#x27;</span>) <span class="hljs-comment"># 取得有id得tag</span><br></code></pre></td></tr></table></figure>
<p>上述的<code>soup.find(&#39;h1&#39;)</code>也可以寫作<code>soup.h1</code>。</p>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><blockquote>
<p>find用.text顯示文字<br>find用.get_text()顯示文字(資料型態須為字串)</p>
</blockquote>
<h4 id="尋找指定的標籤中符合屬性條件的內容"><a href="#尋找指定的標籤中符合屬性條件的內容" class="headerlink" title="尋找指定的標籤中符合屬性條件的內容"></a>尋找指定的標籤中符合屬性條件的內容</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">find(<span class="hljs-string">&quot;標籤名&quot;</span>, &#123; <span class="hljs-string">&quot;屬性名&quot;</span> : <span class="hljs-string">&quot;屬性值&quot;</span>&#125;) 或 find_all(<span class="hljs-string">&quot;標籤名&quot;</span>, &#123; <span class="hljs-string">&quot;屬性名&quot;</span> : <span class="hljs-string">&quot;屬性值&quot;</span>&#125;)<br></code></pre></td></tr></table></figure>
<p>範例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">soup.find(<span class="hljs-string">&#x27;h1&#x27;</span>,&#123;<span class="hljs-string">&#x27;class&#x27;</span>:<span class="hljs-string">&#x27;hello&#x27;</span>&#125;) <span class="hljs-comment"># 印出第一個h4標籤且class名稱為hello中的內容</span><br></code></pre></td></tr></table></figure>
<h4 id="取得標籤的屬性內容"><a href="#取得標籤的屬性內容" class="headerlink" title="取得標籤的屬性內容"></a>取得標籤的屬性內容</h4><p>如果想取得回傳值的屬性內容也可以用<code>get(&quot;屬性名稱&quot;)</code>或是<code>[&quot;屬性名稱&quot;]</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;a <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;link&quot;</span> href=<span class="hljs-string">&quot;http://example.com&quot;</span>&gt;&lt;/a&gt;<br><br>dataList = soup.select(<span class="hljs-string">&quot;#link&quot;</span>)<br><span class="hljs-comment"># 取得href的屬性內容</span><br><span class="hljs-built_in">print</span>(dataList[<span class="hljs-number">0</span>].get(<span class="hljs-string">&quot;href&quot;</span>)) <span class="hljs-comment"># http://example.com</span><br><br><span class="hljs-built_in">print</span>(dataList[<span class="hljs-number">0</span>][<span class="hljs-string">&quot;href&quot;</span>]) <span class="hljs-comment"># http://example.com</span><br></code></pre></td></tr></table></figure>

<h4 id="搜尋多個標籤"><a href="#搜尋多個標籤" class="headerlink" title="搜尋多個標籤"></a>搜尋多個標籤</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">tags = soup.find_all([<span class="hljs-string">&quot;title&quot;</span>, <span class="hljs-string">&quot;p&quot;</span>])<br></code></pre></td></tr></table></figure>
<h4 id="搜尋多個標籤並限制數量"><a href="#搜尋多個標籤並限制數量" class="headerlink" title="搜尋多個標籤並限制數量"></a>搜尋多個標籤並限制數量</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">tags = soup.find_all([<span class="hljs-string">&quot;title&quot;</span>, <span class="hljs-string">&quot;p&quot;</span>], limit=<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure>


<h3 id="select"><a href="#select" class="headerlink" title="select()"></a>select()</h3><p>以CSS選擇器的方式定位元素，讀取指定的資料，回傳值是<strong>list</strong>的資料結構。<br>常見的CSS選擇器:</p>
<ul>
<li>標籤</li>
<li>id(唯一): 要獲取具有id的標籤需在前面加上<code>#</code>，如<code>select(&quot;#title&quot;)</code>，id表唯一的選擇器。</li>
<li>class(類別): 要獲取具有class的標籤需在前面加上<code>.</code>，如<code>select(&quot;.title&quot;)</code>，class選擇器可以同時擁有多個。<br>範例:<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">bs.select(<span class="hljs-string">&#x27;h1&#x27;</span>)      <span class="hljs-comment"># 尋找h1標籤</span><br>bs.select(<span class="hljs-string">&#x27;#id_tag&#x27;</span>)  <span class="hljs-comment"># 尋找id名為id_tag</span><br>bs.select(<span class="hljs-string">&#x27;.class_tag&#x27;</span>)  <span class="hljs-comment"># 尋找class名為Pclass_tag</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="多層"><a href="#多層" class="headerlink" title="多層"></a>多層</h4><p>如果遇上層層嵌套的結構時可以採用範例的方法:<br>獲取<code>html</code>底下的<code>head</code>底下的<code>title</code>標籤內容</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">title = soup.select(<span class="hljs-string">&quot;html head title&quot;</span>)<br></code></pre></td></tr></table></figure>
<h3 id="直接選擇標籤Tag"><a href="#直接選擇標籤Tag" class="headerlink" title="直接選擇標籤Tag"></a>直接選擇標籤Tag</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 輸出title標籤</span><br><span class="hljs-built_in">print</span>(soup.title)<br><span class="hljs-comment"># 輸出title標籤的屬性</span><br><span class="hljs-built_in">print</span>(soup.title.name)<br><span class="hljs-comment"># 輸出title標籤的內容</span><br><span class="hljs-built_in">print</span>(soup.title.string)<br><span class="hljs-comment"># 輸出網頁中的所有文字</span><br>soup.get_text()<br></code></pre></td></tr></table></figure>

<blockquote>
<p>以上為requests&amp;BeautifulSoup常用的方法</p>
</blockquote>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="../../../../../../tags/Python/">Python</a><a class="link-muted mr-2" rel="tag" href="../../../../../../tags/WebScraping/">WebScraping</a></div><!--!--></article></div><!--!--><div class="card"><nav class="post-navigation mt-4 level is-mobile card-content"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="../../../../03/Python/Python/%5BPython%5D%20%E7%88%AC%E8%9F%B2%E7%AD%86%E8%A8%983-%20Selenium/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">[Python] 爬蟲筆記3- Selenium</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="../../../../01/Python/Python/%5BPython%5D%20%E7%88%AC%E8%9F%B2%E7%AD%86%E8%A8%981/"><span class="level-item">[Python] 爬蟲筆記1-基本概念</span><i class="level-item fas fa-chevron-right"></i></a></div></nav></div><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.6.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.6.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "ceb20d3706ddf30a445032674580bd1b",
            repo: "ChenTsungYu.github.io",
            owner: "ChenTsungYu",
            clientID: "7913190f1a943b88e276",
            clientSecret: "8c54a86c8fe06b650efe932eb53bc421ddf84773",
            admin: ["ChenTsungYu"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 20,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="../../../../../../img/avatar.png" alt="Tsung Yu Chen"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Tsung Yu Chen</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Taiwan</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="../../../../../../archives"><p class="title">109</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="../../../../../../categories"><p class="title">8</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="../../../../../../tags"><p class="title">49</p></a></div></div></nav><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ChenTsungYu"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://www.facebook.com/zong.y.r/"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="LinkedIn" href="https://www.linkedin.com/in/tom-chen-1012/"><i class="fab fa-linkedin-in"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#前言"><span class="level-left"><span class="level-item">1</span><span class="level-item">前言</span></span></a></li><li><a class="level is-mobile" href="#所需先備知識-了解網站請求"><span class="level-left"><span class="level-item">2</span><span class="level-item">所需先備知識-了解網站請求</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#安裝requests和bs4"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">安裝requests和bs4</span></span></a></li><li><a class="level is-mobile" href="#引入模組"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">引入模組</span></span></a></li></ul></li><li><a class="level is-mobile" href="#requests"><span class="level-left"><span class="level-item">3</span><span class="level-item">requests</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#GET-Method"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">GET Method</span></span></a></li><li><a class="level is-mobile" href="#POST-Method"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">POST Method</span></span></a></li><li><a class="level is-mobile" href="#Session-Method"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">Session Method</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#實作"><span class="level-left"><span class="level-item">3.3.1</span><span class="level-item">實作:</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#BeautifulSoup"><span class="level-left"><span class="level-item">4</span><span class="level-item">BeautifulSoup</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#常用的方法"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">常用的方法</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#find-、find-all"><span class="level-left"><span class="level-item">4.1.1</span><span class="level-item">find()、find_all()</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#獲取標籤內容"><span class="level-left"><span class="level-item">4.1.1.1</span><span class="level-item">獲取標籤內容</span></span></a></li></ul></li><li><a class="level is-mobile" href="#注意"><span class="level-left"><span class="level-item">4.1.2</span><span class="level-item">注意</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#尋找指定的標籤中符合屬性條件的內容"><span class="level-left"><span class="level-item">4.1.2.1</span><span class="level-item">尋找指定的標籤中符合屬性條件的內容</span></span></a></li><li><a class="level is-mobile" href="#取得標籤的屬性內容"><span class="level-left"><span class="level-item">4.1.2.2</span><span class="level-item">取得標籤的屬性內容</span></span></a></li><li><a class="level is-mobile" href="#搜尋多個標籤"><span class="level-left"><span class="level-item">4.1.2.3</span><span class="level-item">搜尋多個標籤</span></span></a></li><li><a class="level is-mobile" href="#搜尋多個標籤並限制數量"><span class="level-left"><span class="level-item">4.1.2.4</span><span class="level-item">搜尋多個標籤並限制數量</span></span></a></li></ul></li><li><a class="level is-mobile" href="#select"><span class="level-left"><span class="level-item">4.1.3</span><span class="level-item">select()</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#多層"><span class="level-left"><span class="level-item">4.1.3.1</span><span class="level-item">多層</span></span></a></li></ul></li><li><a class="level is-mobile" href="#直接選擇標籤Tag"><span class="level-left"><span class="level-item">4.1.4</span><span class="level-item">直接選擇標籤Tag</span></span></a></li></ul></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="../../../../../../js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-11-27T08:00:19.787Z">2022/11/27</time></p><p class="title"><a href="../../../../../../2022/11/27/DevOps/CICD/GitHub%20Action%20OIDC/">[Github Action] 整合 AWS OIDC 進行 CI/CD 安全強化</a></p><p class="categories"><a href="../../../../../../categories/DevOps/">DevOps</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-06-29T05:23:10.000Z">2022/06/29</time></p><p class="title"><a href="../../../../../../2022/06/29/Database/Index/">[Postgres] 資料庫的索引(Index)</a></p><p class="categories"><a href="../../../../../../categories/Backend/">Backend</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-06-20T05:23:10.000Z">2022/06/20</time></p><p class="title"><a href="../../../../../../2022/06/20/Database/%E8%B3%87%E6%96%99%E5%BA%AB%E5%A6%82%E4%BD%95%E5%AD%98%E6%94%BE%E8%B3%87%E6%96%99/">[Postgres] 資料庫裡的儲存概念</a></p><p class="categories"><a href="../../../../../../categories/Backend/">Backend</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-15T05:23:10.000Z">2022/01/15</time></p><p class="title"><a href="../../../../../../2022/01/15/Database/Redis/%5BBackend%5D%20%E6%8F%90%E9%AB%98%20Redis%20%E5%9F%B7%E8%A1%8C%E6%95%88%E7%8E%87%E7%9A%84%E6%96%B9%E6%B3%95%20-%20Pipeline/">[Redis] 提高 Redis 執行效率的方法 - Pipeline</a></p><p class="categories"><a href="../../../../../../categories/Backend/">Backend</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-11T05:23:10.000Z">2022/01/11</time></p><p class="title"><a href="../../../../../../2022/01/11/Database/Redis/%5BBackend%5D%20Redis%20-%20Transction/">[Redis] Redis - Transaction</a></p><p class="categories"><a href="../../../../../../categories/Backend/">Backend</a></p></div></article></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="../../../../../../index.html"><img class="logo-img" src="../../../../../../img/dragon_blue.png" alt="Tom&#039;s Blog" height="28"><img class="logo-img-dark" src="../../../../../../img/dragon_red.png" alt="Tom&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2022 Tsung Yu Chen</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ChenTsungYu"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="../../../../../../js/column.js"></script><script src="../../../../../../js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="../../../../../../js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="../../../../../../js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="../../../../../../js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"../../../../../../content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script><script type="text/javascript" src="/js/imaegoo/universe.js"></script></body></html>